# Kaggle Competition


## 최종 선택 모델

***ConvNext***   
* mDice의 점수가 가장 좋고, LB의 값이 가장 높았음
  


## About Submission Code (For Ensemble)
- - -
#### 문제점

1. mmsegmentation은 확률이 아닌, 어떤 클래스인지를 예측하기 때문에 해당 픽셀의 위치에 클래스에 대한 값만 나타남
2. Multi-class로 학습한 경우, 특정 클래스의 이미지에 다른 클래스의 값이 예측될 수 있음
    예를 들어, spleen에 해당하는 사진에 kidney로 예측하는 픽셀값이 나올 수 있음
3. 위와 같은 오류는 점수 하락의 원인이 되기 때문에, 가장 많이 예측된 class를 제외한 값들을 제외하고자 함

#### 해결 과정

1. 한 image에 예측된 값들을 모두 flatten
2. 모든 예측된 값들을 Counter함수를 통해 빈도수 계산
3. 0번(Background)을 제외한 나머지 값 중 가장 큰 값을 제외한 나머지는 모두 0번으로 재설정
4. image 안에서 아무 것도 예측하지 못하는 경우가 존재할 수 있기 때문에 if문을 사용해서 예측값이 2개 이상인 경우에만 바꿔주는 방법으로 설정

#### 결과

* 똑같은 가중치로 돌렸을 때, score의 소폭 상승이 존재하였음.
